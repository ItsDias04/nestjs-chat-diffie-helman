<div class="ecdsa-container">
  <!-- Header -->
  <div class="header">
    <h1>üîê ECDSA –≤ –ë–ª–æ–∫—á–µ–π–Ω: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ8</h1>
    <p class="subtitle">–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞–Ω–∞–ª–∏–∑ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏ ECDSA (Bitcoin/Ethereum)</p>
    
    <div class="network-selector">
      <label>–ë–ª–æ–∫—á–µ–π–Ω-—Å–µ—Ç—å:</label>
      <select [(ngModel)]="selectedNetwork" (change)="resetAll()">
        <option *ngFor="let network of networks" [value]="network">{{ network }}</option>
      </select>
      <small>{{ getNetworkInfo() }}</small>
    </div>
  </div>

  <!-- Theory Section -->
  <div class="theory-section" [class.collapsed]="!showTheory">
    <button class="theory-toggle" (click)="toggleTheory()">
      {{ showTheory ? '‚ñº' : '‚ñ∂' }} –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è
    </button>
    
    <div class="theory-content" *ngIf="showTheory">
      <div class="theory-grid">
        <div class="theory-card">
          <h3>üìö –ß—Ç–æ —Ç–∞–∫–æ–µ ECDSA?</h3>
          <p><strong>ECDSA</strong> (Elliptic Curve Digital Signature Algorithm) ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö.</p>
          <ul>
            <li>–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –º–µ–Ω—å—à–µ–π –¥–ª–∏–Ω–µ –∫–ª—é—á–∞</li>
            <li>256-–±–∏—Ç–Ω—ã–π –∫–ª—é—á ECDSA ‚âà 3072-–±–∏—Ç–Ω—ã–π –∫–ª—é—á RSA</li>
            <li>–ë—ã—Å—Ç—Ä–µ–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤</li>
          </ul>
        </div>

        <div class="theory-card">
          <h3>üîë –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ</h3>
          <p>–í –±–ª–æ–∫—á–µ–π–Ω-—Å–µ—Ç—è—Ö ECDSA –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:</p>
          <ul>
            <li><strong>–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</strong> ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞</li>
            <li><strong>–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö</strong> ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π</li>
            <li><strong>–ù–µ–æ—Ç–∫–∞–∑—É–µ–º–æ—Å—Ç–∏</strong> ‚Äî –Ω–µ–ª—å–∑—è –æ—Ç—Ä–∏—Ü–∞—Ç—å –∞–≤—Ç–æ—Ä—Å—Ç–≤–æ</li>
          </ul>
          <p><strong>Bitcoin & Ethereum:</strong> –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—Ä–∏–≤—É—é secp256k1</p>
        </div>

        <div class="theory-card">
          <h3>‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏ ECDSA</h3>
          <ol>
            <li><strong>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π:</strong> private key ‚Üí public key</li>
            <li><strong>–•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:</strong> SHA-256 –∏–ª–∏ Keccak-256</li>
            <li><strong>–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏:</strong> (r, s) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞</li>
            <li><strong>–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º</li>
          </ol>
        </div>

        <div class="theory-card formula-card">
          <h3>üìê –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞</h3>
          <div class="formula-box">
            <p><strong>–≠–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∞—è –∫—Ä–∏–≤–∞—è:</strong></p>
            <div class="formula">y¬≤ = x¬≥ + ax + b (mod p)</div>
            <p><strong>secp256k1:</strong></p>
            <div class="formula">y¬≤ = x¬≥ + 7 (mod p)</div>
            <p><strong>–ü–æ–¥–ø–∏—Å—å (r, s):</strong></p>
            <div class="formula">
              r = (k √ó G)<sub>x</sub> mod n<br>
              s = k‚Åª¬π(hash + r √ó privKey) mod n
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Progress Steps -->
  <div class="progress-steps">
    <div class="step" [class.active]="currentStep >= 1" [class.completed]="currentStep > 1" (click)="goToStep(1)">
      <div class="step-number">1</div>
      <div class="step-label">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π</div>
    </div>
    <div class="step-line" [class.active]="currentStep >= 2"></div>
    <div class="step" [class.active]="currentStep >= 2" [class.completed]="currentStep > 2" (click)="goToStep(2)">
      <div class="step-number">2</div>
      <div class="step-label">–°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</div>
    </div>
    <div class="step-line" [class.active]="currentStep >= 3"></div>
    <div class="step" [class.active]="currentStep >= 3" [class.completed]="currentStep > 3" (click)="goToStep(3)">
      <div class="step-number">3</div>
      <div class="step-label">–ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ</div>
    </div>
    <div class="step-line" [class.active]="currentStep >= 4"></div>
    <div class="step" [class.active]="currentStep >= 4" [class.completed]="currentStep > 4" (click)="goToStep(4)">
      <div class="step-number">4</div>
      <div class="step-label">–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è</div>
    </div>
    <div class="step-line" [class.active]="currentStep >= 5"></div>
    <div class="step" [class.active]="currentStep >= 5" [class.completed]="currentStep > 5" (click)="goToStep(5)">
      <div class="step-number">5</div>
      <div class="step-label">–¢–µ—Å—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è</div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="main-content">
    
    <!-- Step 1: Key Generation -->
    <div class="section" *ngIf="currentStep === 1">
      <h2>–®–∞–≥ 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—ã –∫–ª—é—á–µ–π ECDSA</h2>
      <p>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∏ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–µ–π –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π <strong>{{ selectedNetwork }}</strong></p>
      
      <div class="action-box">
        <button class="btn-primary btn-large" (click)="generateKeyPair()">
          üîë –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä—É –∫–ª—é—á–µ–π
        </button>
      </div>

      <div class="key-display" *ngIf="keyPair">
        <div class="key-card private-key-card">
          <h3>üîí –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (Private Key)</h3>
          <div class="key-value">
            <code *ngIf="showPrivateKey">{{ keyPair.privateKey }}</code>
            <code *ngIf="!showPrivateKey">{{ '‚Ä¢'.repeat(64) }}</code>
            <button class="btn-icon" (click)="togglePrivateKeyVisibility()">
              {{ showPrivateKey ? 'üëÅÔ∏è' : 'üôà' }}
            </button>
            <button class="btn-icon" (click)="copyToClipboard(keyPair.privateKey, '–ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á')">üìã</button>
          </div>
          <div class="warning">
            ‚ö†Ô∏è <strong>–í–ê–ñ–ù–û:</strong> –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º!
          </div>
        </div>

        <div class="key-card public-key-card">
          <h3>üîì –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (Public Key)</h3>
          <div class="key-value">
            <code>{{ formatHash(keyPair.publicKey, 32) }}</code>
            <button class="btn-icon" (click)="copyToClipboard(keyPair.publicKey, '–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á')">üìã</button>
          </div>
        </div>

        <div class="key-card address-card">
          <h3>üìç –ê–¥—Ä–µ—Å (Address)</h3>
          <div class="key-value">
            <code>{{ keyPair.address }}</code>
            <button class="btn-icon" (click)="copyToClipboard(keyPair.address, '–ê–¥—Ä–µ—Å')">üìã</button>
          </div>
          <p class="info-text">–≠—Ç–æ—Ç –∞–¥—Ä–µ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</p>
        </div>

        <div class="action-box">
          <button class="btn-success" (click)="currentStep = 2">
            –î–∞–ª–µ–µ: –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é ‚Üí
          </button>
        </div>
      </div>
    </div>

    <!-- Step 2: Create Transaction -->
    <div class="section" *ngIf="currentStep === 2">
      <h2>–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h2>
      <p>–°—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä—É—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–¥–ø–∏—Å–∞—Ç—å</p>

      <div class="transaction-form">
        <div class="form-group">
          <label>–û—Ç (From):</label>
          <input type="text" [value]="keyPair?.address" disabled>
        </div>

        <div class="form-group">
          <label>–ö–æ–º—É (To):</label>
          <input type="text" [(ngModel)]="recipientAddress" placeholder="0x...">
        </div>

        <div class="form-group">
          <label>–°—É–º–º–∞:</label>
          <input type="number" [(ngModel)]="transactionAmount" step="0.01" min="0">
        </div>

        <div class="form-group">
          <label>–°–æ–æ–±—â–µ–Ω–∏–µ/–û–ø–∏—Å–∞–Ω–∏–µ:</label>
          <textarea [(ngModel)]="transactionMessage" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏..."></textarea>
        </div>

        <div class="action-box">
          <button class="btn-primary" (click)="createTransaction()">
            üìù –°–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
          </button>
        </div>
      </div>

      <div class="transaction-preview" *ngIf="originalTransaction">
        <h3>–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:</h3>
        <div class="transaction-details">
          <div class="detail-row">
            <span class="label">Hash:</span>
            <code>{{ formatHash(originalTransaction.hash, 16) }}</code>
          </div>
          <div class="detail-row">
            <span class="label">From:</span>
            <code>{{ formatHash(originalTransaction.from, 10) }}</code>
          </div>
          <div class="detail-row">
            <span class="label">To:</span>
            <code>{{ formatHash(originalTransaction.to, 10) }}</code>
          </div>
          <div class="detail-row">
            <span class="label">Amount:</span>
            <strong>{{ originalTransaction.amount }} {{ selectedNetwork.includes('Bitcoin') ? 'BTC' : 'ETH' }}</strong>
          </div>
          <div class="detail-row">
            <span class="label">Timestamp:</span>
            <span>{{ formatTimestamp(originalTransaction.timestamp) }}</span>
          </div>
        </div>

        <div class="action-box">
          <button class="btn-success" (click)="currentStep = 3">
            –î–∞–ª–µ–µ: –ü–æ–¥–ø–∏—Å–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é ‚Üí
          </button>
        </div>
      </div>
    </div>

    <!-- Step 3: Sign Transaction -->
    <div class="section" *ngIf="currentStep === 3">
      <h2>–®–∞–≥ 3: –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h2>
      <p>–°–æ–∑–¥–∞–Ω–∏–µ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏ ECDSA —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞</p>

      <div class="info-box">
        <h4>–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è:</h4>
        <ol>
          <li>–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ö—ç—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: <code>hash = SHA-256(transaction)</code></li>
          <li>–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ k</li>
          <li>–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–∞ –Ω–∞ –∫—Ä–∏–≤–æ–π: <code>R = k √ó G</code></li>
          <li>–ò–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è r = R<sub>x</sub> mod n</li>
          <li>–í—ã—á–∏—Å–ª—è–µ—Ç—Å—è s = k‚Åª¬π(hash + r √ó privateKey) mod n</li>
          <li>–ü–æ–¥–ø–∏—Å—å = (r, s, v)</li>
        </ol>
      </div>

      <div class="action-box" *ngIf="originalTransaction">
        <button class="btn-primary btn-large" (click)="signTransaction()">
          ‚úçÔ∏è –ü–æ–¥–ø–∏—Å–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        </button>
      </div>

      <div class="signature-result" *ngIf="signedTransaction && signedTransaction.signature">
        <h3>‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω–∞!</h3>
        
        <div class="signature-details">
          <div class="signature-component">
            <h4>r (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X —Ç–æ—á–∫–∏ –Ω–∞ –∫—Ä–∏–≤–æ–π):</h4>
            <code>{{ formatHash(signedTransaction.signature.r, 16) }}</code>
          </div>
          
          <div class="signature-component">
            <h4>s (–ø–æ–¥–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è):</h4>
            <code>{{ formatHash(signedTransaction.signature.s, 16) }}</code>
          </div>
          
          <div class="signature-component">
            <h4>v (recovery id):</h4>
            <code>{{ signedTransaction.signature.v }}</code>
          </div>
        </div>

        <div class="action-box">
          <button class="btn-secondary" (click)="exportTransaction(signedTransaction)">
            üíæ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
          </button>
          <button class="btn-success" (click)="currentStep = 4">
            –î–∞–ª–µ–µ: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å ‚Üí
          </button>
        </div>
      </div>
    </div>

    <!-- Step 4: Verify Signature -->
    <div class="section" *ngIf="currentStep === 4">
      <h2>–®–∞–≥ 4: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏</h2>
      <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏ –ø–æ–¥–ø–∏—Å–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞</p>

      <div class="info-box">
        <h4>–ü—Ä–æ—Ü–µ—Å—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:</h4>
        <ol>
          <li>–ü–æ–ª—É—á–∞–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è</li>
          <li>–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ö—ç—à —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</li>
          <li>–ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–¥–ø–∏—Å–∏ (r, s)</li>
          <li>–ü—Ä–æ–≤–µ—Ä—è–µ–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π</li>
          <li>–ï—Å–ª–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è ‚Üí –ø–æ–¥–ø–∏—Å—å –≤–∞–ª–∏–¥–Ω–∞ ‚úÖ</li>
        </ol>
      </div>

      <div class="action-box">
        <button class="btn-primary btn-large" (click)="verifySignature()">
          üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å
        </button>
      </div>

      <div class="verification-result" *ngIf="verificationResult !== null">
        <div class="result-card" [class.valid]="verificationResult" [class.invalid]="!verificationResult">
          <div class="result-icon">
            {{ verificationResult ? '‚úÖ' : '‚ùå' }}
          </div>
          <h3>{{ verificationResult ? '–ü–æ–¥–ø–∏—Å—å –≤–∞–ª–∏–¥–Ω–∞!' : '–ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞!' }}</h3>
          <p *ngIf="verificationResult">
            –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –û—Ç–∫—Ä—ã—Ç—ã–π –∫–ª—é—á —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–≤–∞—Ç–Ω–æ–º—É –∫–ª—é—á—É, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–º—É –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.
          </p>
          <p *ngIf="!verificationResult">
            –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫—É. –í–æ–∑–º–æ–∂–Ω–æ, –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á.
          </p>
        </div>

        <div class="action-box">
          <button class="btn-success" (click)="currentStep = 5">
            –î–∞–ª–µ–µ: –¢–µ—Å—Ç —Å –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º ‚Üí
          </button>
        </div>
      </div>
    </div>

    <!-- Step 5: Test Modified Transaction -->
    <div class="section" *ngIf="currentStep === 5">
      <h2>–®–∞–≥ 5: –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º</h2>
      <p>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≥–æ, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–µ–ª–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π</p>

      <div class="warning-box">
        <h4>‚ö†Ô∏è –í–∞–∂–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:</h4>
        <p>–õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–µ–ª–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–π. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∏ –Ω–µ–∏–∑–º–µ–Ω–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ –±–ª–æ–∫—á–µ–π–Ω–µ.</p>
      </div>

      <div class="form-group">
        <label>–ò–∑–º–µ–Ω—ë–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</label>
        <textarea [(ngModel)]="modifiedMessage" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–∑–º–µ–Ω—ë–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
      </div>

      <div class="action-box">
        <button class="btn-warning" (click)="createModifiedTransaction()">
          üìù –°–æ–∑–¥–∞—Ç—å –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        </button>
      </div>

      <div class="comparison-view" *ngIf="modifiedTransaction">
        <div class="comparison-grid">
          <div class="comparison-card original">
            <h4>üìÑ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è</h4>
            <code>Hash: {{ formatHash(signedTransaction?.hash || '', 12) }}</code>
          </div>

          <div class="comparison-card modified">
            <h4>üìù –ò–∑–º–µ–Ω—ë–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è</h4>
            <code>Hash: {{ formatHash(modifiedTransaction.hash, 12) }}</code>
          </div>
        </div>

        <div class="action-box">
          <button class="btn-primary" (click)="verifyModifiedTransaction()">
            üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω—ë–Ω–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
          </button>
        </div>

        <div class="verification-result" *ngIf="modifiedVerificationResult !== null">
          <div class="result-card invalid">
            <div class="result-icon">‚ùå</div>
            <h3>–ü–æ–¥–ø–∏—Å—å –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –¥–ª—è –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö!</h3>
            <p>
              –•—ç—à –∏–∑–º–µ–Ω—ë–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º —Ö—ç—à–æ–º. 
              –ü–æ–¥–ø–∏—Å—å, —Å–æ–∑–¥–∞–Ω–Ω–∞—è –¥–ª—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
            </p>
            <div class="explanation-box">
              <strong>–í—ã–≤–æ–¥:</strong> –≠—Ç–æ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ ECDSA –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö. 
              –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –Ω–µ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –±–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞.
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <!-- Transaction History -->
  <div class="section history-section" *ngIf="transactionHistory.length > 0">
    <h2>üìú –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h2>
    <div class="transaction-list">
      <div class="transaction-item" *ngFor="let tx of transactionHistory; let i = index">
        <div class="tx-header">
          <span class="tx-number">#{{ transactionHistory.length - i }}</span>
          <span class="tx-time">{{ formatTimestamp(tx.timestamp) }}</span>
        </div>
        <div class="tx-details">
          <div><strong>From:</strong> <code>{{ formatHash(tx.from, 8) }}</code></div>
          <div><strong>To:</strong> <code>{{ formatHash(tx.to, 8) }}</code></div>
          <div><strong>Amount:</strong> {{ tx.amount }}</div>
          <div><strong>Hash:</strong> <code>{{ formatHash(tx.hash, 12) }}</code></div>
        </div>
        <button class="btn-small" (click)="exportTransaction(tx)">üíæ –≠–∫—Å–ø–æ—Ä—Ç</button>
      </div>
    </div>
  </div>

  <!-- Control Questions -->
  <div class="section questions-section">
    <h2>‚ùì –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
    <div class="questions-list">
      <details class="question-item">
        <summary>1. –í —á—ë–º –æ—Ç–ª–∏—á–∏–µ ECDSA –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ RSA-–ø–æ–¥–ø–∏—Å–∞–Ω–∏—è?</summary>
        <div class="answer">
          <ul>
            <li><strong>–î–ª–∏–Ω–∞ –∫–ª—é—á–∞:</strong> ECDSA –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–æ–ª–µ–µ –∫–æ—Ä–æ—Ç–∫–∏–µ –∫–ª—é—á–∏ (256 –±–∏—Ç ‚âà 3072 –±–∏—Ç RSA)</li>
            <li><strong>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> ECDSA –±—ã—Å—Ç—Ä–µ–µ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∏</li>
            <li><strong>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞:</strong> ECDSA –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö, RSA ‚Äî –Ω–∞ —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</li>
            <li><strong>–†–∞–∑–º–µ—Ä –ø–æ–¥–ø–∏—Å–∏:</strong> –ü–æ–¥–ø–∏—Å–∏ ECDSA –º–µ–Ω—å—à–µ –ø–æ —Ä–∞–∑–º–µ—Ä—É</li>
          </ul>
        </div>
      </details>

      <details class="question-item">
        <summary>2. –ü–æ—á–µ–º—É –±–ª–æ–∫—á–µ–π–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–º–µ–Ω–Ω–æ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏–≤—ã–µ secp256k1?</summary>
        <div class="answer">
          <ul>
            <li><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
            <li><strong>–°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è:</strong> –®–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –∫—Ä–∏–≤–∞—è</li>
            <li><strong>–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:</strong> –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ –≤–∞–∂–Ω—ã –¥–ª—è –±–ª–æ–∫—á–µ–π–Ω–∞</li>
            <li><strong>–°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:</strong> –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π –≤ —Å–µ—Ç–∏</li>
          </ul>
        </div>
      </details>

      <details class="question-item">
        <summary>3. –ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ—Å–ª–µ –µ—ë –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è?</summary>
        <div class="answer">
          <p>–ù–µ–∏–∑–º–µ–Ω–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑:</p>
          <ul>
            <li><strong>–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Ö—ç—à:</strong> –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–Ω—è–µ—Ç —Ö—ç—à</li>
            <li><strong>–¶–∏—Ñ—Ä–æ–≤–∞—è –ø–æ–¥–ø–∏—Å—å:</strong> –ü–æ–¥–ø–∏—Å—å –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ö—ç—à—É</li>
            <li><strong>–ü—É–±–ª–∏—á–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è:</strong> –õ—é–±–æ–π —É–∑–µ–ª –º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å</li>
            <li><strong>–ö–æ–Ω—Å–µ–Ω—Å—É—Å —Å–µ—Ç–∏:</strong> –ò–∑–º–µ–Ω—ë–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±—É–¥–µ—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞</li>
          </ul>
        </div>
      </details>

      <details class="question-item">
        <summary>4. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –µ—Å–ª–∏ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á —É—Ç–µ—á—ë—Ç?</summary>
        <div class="answer">
          <p><strong>–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:</strong></p>
          <ul>
            <li>‚ùå –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –ø–æ–ª—É—á–∏—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏</li>
            <li>‚ùå –°–º–æ–∂–µ—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç –≤–∞—à–µ–≥–æ –∏–º–µ–Ω–∏</li>
            <li>‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –∫–ª—é—á –≤ –±–ª–æ–∫—á–µ–π–Ω–µ</li>
            <li>‚úÖ –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ –Ω–æ–≤—ã–π –∞–¥—Ä–µ—Å</li>
          </ul>
        </div>
      </details>

      <details class="question-item">
        <summary>5. –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –ø–∞—Ä—É –∫–ª—é—á–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –±–ª–æ–∫—á–µ–π–Ω-—Å–µ—Ç–µ–π?</summary>
        <div class="answer">
          <p><strong>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–æ –ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</strong></p>
          <ul>
            <li>‚ö†Ô∏è –†–∞–∑–Ω—ã–µ —Å–µ—Ç–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∞–¥—Ä–µ—Å–æ–≤</li>
            <li>‚ö†Ô∏è –ü–æ–≤—ã—à–∞–µ—Ç—Å—è —Ä–∏—Å–∫ –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏ –∫–ª—é—á–∞</li>
            <li>‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã replay-–∞—Ç–∞–∫–∏ –º–µ–∂–¥—É —Å–µ—Ç—è–º–∏</li>
            <li>‚úÖ –õ—É—á—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å–µ—Ç–∏</li>
          </ul>
        </div>
      </details>
    </div>
  </div>

  <!-- Footer Actions -->
  <div class="footer-actions">
    <button class="btn-danger" (click)="resetAll()">
      üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë
    </button>
    <button class="btn-secondary" (click)="currentStep = 1">
      ‚¨ÖÔ∏è –í –Ω–∞—á–∞–ª–æ
    </button>
  </div>
</div>
