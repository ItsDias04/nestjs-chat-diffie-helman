<div class="ecdsa-lab-container">
  <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –≤–∫–ª–∞–¥–∫–∞–º -->
  <div class="tabs-navigation">
    <button 
      [class.active]="currentTab === 'theory'" 
      (click)="switchTab('theory')">
      üìö –¢–µ–æ—Ä–∏—è
    </button>
    <button 
      [class.active]="currentTab === 'task1'" 
      (click)="switchTab('task1')">
      1Ô∏è‚É£ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π
    </button>
    <button 
      [class.active]="currentTab === 'task2'" 
      (click)="switchTab('task2')">
      2Ô∏è‚É£ –ü–æ–¥–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è
    </button>
    <button 
      [class.active]="currentTab === 'task3'" 
      (click)="switchTab('task3')">
      3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏
    </button>
    <button 
      [class.active]="currentTab === 'task4'" 
      (click)="switchTab('task4')">
      4Ô∏è‚É£ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç
    </button>
    <button 
      [class.active]="currentTab === 'task5'" 
      (click)="switchTab('task5')">
      5Ô∏è‚É£ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
    </button>
    <button 
      [class.active]="currentTab === 'questions'" 
      (click)="switchTab('questions')">
      ‚ùì –í–æ–ø—Ä–æ—Å—ã
    </button>
    <button class="download-btn" (click)="downloadReport()">
      üíæ –°–∫–∞—á–∞—Ç—å –æ—Ç—á—ë—Ç
    </button>
  </div>

  <!-- –¢–ï–û–†–ï–¢–ò–ß–ï–°–ö–ê–Ø –ß–ê–°–¢–¨ -->
  <div class="tab-content" *ngIf="currentTab === 'theory'">
    <div class="theory-section">
      <h1>üîê ECDSA –≤ –±–ª–æ–∫—á–µ–π–Ω–µ: Bitcoin –∏ Ethereum</h1>
      
      <div class="info-block">
        <h2>–ß—Ç–æ —Ç–∞–∫–æ–µ ECDSA?</h2>
        <p>
          <strong>ECDSA (Elliptic Curve Digital Signature Algorithm)</strong> ‚Äî 
          –∞–ª–≥–æ—Ä–∏—Ç–º —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö.
          –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –º–µ–Ω—å—à–µ–π –¥–ª–∏–Ω–µ –∫–ª—é—á–∞ 
          –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å RSA.
        </p>
      </div>

      <div class="info-block">
        <h2>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ</h2>
        <ul>
          <li><strong>Bitcoin:</strong> –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ECDSA –Ω–∞ –∫—Ä–∏–≤–æ–π secp256k1</li>
          <li><strong>Ethereum:</strong> —Ç–∞–∫–∂–µ secp256k1, –Ω–æ —Å Keccak-256 —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º</li>
          <li><strong>–¶–µ–ª—å:</strong> –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –±–µ–∑ —Ä–∞—Å–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞</li>
        </ul>
      </div>

      <div class="info-block">
        <h2>–û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã</h2>
        <ol>
          <li><strong>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π:</strong> —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø–∞—Ä–∞ (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π, –ø—É–±–ª–∏—á–Ω—ã–π) –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π</li>
          <li><strong>–•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:</strong> —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ —Ö—ç—à (SHA-256)</li>
          <li><strong>–ü–æ–¥–ø–∏—Å—å:</strong> —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞</li>
          <li><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞:</strong> –ø–æ–¥–ø–∏—Å—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞</li>
        </ol>
      </div>

      <div class="info-block warning">
        <h3>‚ö†Ô∏è –í–∞–∂–Ω–æ!</h3>
        <p>
          –£—Ç–µ—á–∫–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –æ–∑–Ω–∞—á–∞–µ—Ç –ø–æ–ª–Ω—É—é –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—é –∞–∫–∫–∞—É–Ω—Ç–∞.
          –í –±–ª–æ–∫—á–µ–π–Ω–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ "–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å" ‚Äî –∫–ª—é—á —ç—Ç–æ –∏ –µ—Å—Ç—å –≤–∞—à–∞ –ª–∏—á–Ω–æ—Å—Ç—å.
        </p>
      </div>

      <div class="info-block success">
        <h3>‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ECDSA</h3>
        <ul>
          <li>–ö–æ—Ä–æ—Ç–∫–∏–µ –∫–ª—é—á–∏ (256 –±–∏—Ç –ø—Ä–æ—Ç–∏–≤ 2048 –±–∏—Ç RSA)</li>
          <li>–ë—ã—Å—Ç—Ä—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–¥–ø–∏—Å–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏</li>
          <li>–ú–µ–Ω—å—à–∏–π —Ä–∞–∑–º–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</li>
          <li>–í—ã—Å–æ–∫–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Å—Ç–æ–π–∫–æ—Å—Ç—å</li>
        </ul>
      </div>
    </div>
  </div>

  <!-- –ó–ê–î–ê–ù–ò–ï 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—ã –∫–ª—é—á–µ–π -->
  <div class="tab-content" *ngIf="currentTab === 'task1'">
    <h2>–ó–∞–¥–∞–Ω–∏–µ 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—ã –∫–ª—é—á–µ–π ECDSA</h2>
    
    <div class="task-description">
      <p>
        –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø–∞—Ä—É –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–ª—é—á–µ–π –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π 
        <strong>secp256k1</strong> (—Å—Ç–∞–Ω–¥–∞—Ä—Ç Bitcoin/Ethereum).
      </p>
    </div>

    <button class="primary-btn" (click)="generateKeyPair()">
      üîë –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –ø–∞—Ä—É –∫–ª—é—á–µ–π
    </button>

    <div class="result-block" *ngIf="generatedKeys">
      <h3>‚úÖ –ö–ª—é—á–∏ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã</h3>
      
      <div class="key-display">
        <label>üî¥ –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á (Private Key):</label>
        <div class="key-value">
          <code>{{ generatedKeys.privateKey }}</code>
          <button class="copy-btn" (click)="copyToClipboard(generatedKeys.privateKey)">üìã</button>
        </div>
        <p class="hint">‚ö†Ô∏è –ù–ò–ö–û–ì–î–ê –Ω–µ –¥–µ–ª–∏—Ç–µ—Å—å –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º!</p>
      </div>

      <div class="key-display">
        <label>üü¢ –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (Public Key):</label>
        <div class="key-value">
          <code>{{ generatedKeys.publicKey }}</code>
          <button class="copy-btn" (click)="copyToClipboard(generatedKeys.publicKey)">üìã</button>
        </div>
      </div>

      <div class="key-display">
        <label>üîµ –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á (—Å–∂–∞—Ç—ã–π):</label>
        <div class="key-value">
          <code>{{ generatedKeys.publicKeyCompressed }}</code>
          <button class="copy-btn" (click)="copyToClipboard(generatedKeys.publicKeyCompressed)">üìã</button>
        </div>
        <p class="hint">–°–∂–∞—Ç—ã–π —Ñ–æ—Ä–º–∞—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ</p>
      </div>
    </div>
  </div>

  <!-- –ó–ê–î–ê–ù–ò–ï 2: –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è -->
  <div class="tab-content" *ngIf="currentTab === 'task2'">
    <h2>–ó–∞–¥–∞–Ω–∏–µ 2: –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)</h2>
    
    <div class="task-description">
      <p>
        –ü–æ–¥–ø–∏—à–∏—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞.
        –≠—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ.
      </p>
    </div>

    <div class="input-group">
      <label>–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏:</label>
      <textarea 
        [(ngModel)]="messageToSign" 
        rows="3" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏..."></textarea>
    </div>

    <button 
      class="primary-btn" 
      (click)="signMessage()"
      [disabled]="!generatedKeys">
      ‚úçÔ∏è –ü–æ–¥–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
    </button>

    <p class="hint" *ngIf="!generatedKeys">
      ‚ö†Ô∏è –°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏ –≤ –ó–∞–¥–∞–Ω–∏–∏ 1
    </p>

    <div class="result-block" *ngIf="signature">
      <h3>‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∞–Ω–æ</h3>
      
      <div class="signature-display">
        <label>üìù –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</label>
        <code>{{ messageToSign }}</code>
      </div>

      <div class="signature-display">
        <label>üîç SHA-256 Hash:</label>
        <code>{{ messageHash }}</code>
      </div>

      <div class="signature-display">
        <label>üìú –ü–æ–¥–ø–∏—Å—å (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç r):</label>
        <code>{{ signature.r }}</code>
      </div>

      <div class="signature-display">
        <label>üìú –ü–æ–¥–ø–∏—Å—å (–∫–æ–º–ø–æ–Ω–µ–Ω—Ç s):</label>
        <code>{{ signature.s }}</code>
      </div>

      <div class="signature-display">
        <label>üì¶ –ü–æ–¥–ø–∏—Å—å (DER format, hex):</label>
        <div class="key-value">
          <code>{{ signatureHex }}</code>
          <button class="copy-btn" (click)="copyToClipboard(signatureHex)">üìã</button>
        </div>
      </div>

      <p class="info-text">
        ‚ÑπÔ∏è –ü–æ–¥–ø–∏—Å—å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (r, s). –í Bitcoin/Ethereum –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 
        DER-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è.
      </p>
    </div>
  </div>

  <!-- –ó–ê–î–ê–ù–ò–ï 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ -->
  <div class="tab-content" *ngIf="currentTab === 'task3'">
    <h2>–ó–∞–¥–∞–Ω–∏–µ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏</h2>
    
    <div class="task-description">
      <p>
        –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∏, –∏—Å–ø–æ–ª—å–∑—É—è –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á.
        –≠—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–æ–¥–∞–º–∏ –±–ª–æ–∫—á–µ–π–Ω–∞.
      </p>
    </div>

    <button class="secondary-btn" (click)="useDataFromTask2()">
      üì• –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –ó–∞–¥–∞–Ω–∏—è 2
    </button>

    <div class="input-group">
      <label>–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
      <textarea 
        [(ngModel)]="verificationMessage" 
        rows="2" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
    </div>

    <div class="input-group">
      <label>–ü–æ–¥–ø–∏—Å—å (DER hex):</label>
      <input 
        type="text" 
        [(ngModel)]="verificationSignature" 
        placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –ø–æ–¥–ø–∏—Å—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ hex...">
    </div>

    <div class="input-group">
      <label>–ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á:</label>
      <input 
        type="text" 
        [(ngModel)]="verificationPublicKey" 
        placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á...">
    </div>

    <button class="primary-btn" (click)="verifySignature()">
      ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å—å
    </button>

    <div class="result-block success" *ngIf="verificationResult === true">
      <h3>‚úÖ –ü–æ–¥–ø–∏—Å—å –í–ê–õ–ò–î–ù–ê</h3>
      <p>–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∞–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º.</p>
      <p>–í –±–ª–æ–∫—á–µ–π–Ω–µ —ç—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±—ã–ª–∞ –±—ã –ø—Ä–∏–Ω—è—Ç–∞ —Å–µ—Ç—å—é.</p>
    </div>

    <div class="result-block error" *ngIf="verificationResult === false">
      <h3>‚ùå –ü–æ–¥–ø–∏—Å—å –ù–ï–í–ê–õ–ò–î–ù–ê</h3>
      <p>–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ–¥–ø–∏—Å–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á.</p>
      <p *ngIf="verificationError">–û—à–∏–±–∫–∞: {{ verificationError }}</p>
    </div>
  </div>

  <!-- –ó–ê–î–ê–ù–ò–ï 4: –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å –∏–∑–º–µ–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö -->
  <div class="tab-content" *ngIf="currentTab === 'task4'">
    <h2>–ó–∞–¥–∞–Ω–∏–µ 4: –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç ‚Äî –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</h2>
    
    <div class="task-description">
      <p>
        –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ–º, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–∂–µ –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ 
        –¥–µ–ª–∞–µ—Ç –ø–æ–¥–ø–∏—Å—å –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–π. –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –±–ª–æ–∫—á–µ–π–Ω–µ.
      </p>
    </div>

    <div class="input-group">
      <label>üü¢ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</label>
      <input 
        type="text" 
        [(ngModel)]="originalMessage" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
    </div>

    <div class="input-group">
      <label>üî¥ –ò–∑–º–µ–Ω—ë–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:</label>
      <input 
        type="text" 
        [(ngModel)]="tamperedMessage" 
        placeholder="–ò–∑–º–µ–Ω–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
    </div>

    <button class="primary-btn" (click)="runTamperingExperiment()">
      üß™ –ü—Ä–æ–≤–µ—Å—Ç–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç
    </button>

    <div class="result-block" *ngIf="originalSignature">
      <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞</h3>
      
      <div class="experiment-result">
        <div class="comparison-row">
          <div class="comparison-col">
            <h4>üü¢ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h4>
            <p><strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> {{ originalMessage }}</p>
            <p><strong>Hash:</strong> <code>{{ originalHash }}</code></p>
            <p><strong>–ü–æ–¥–ø–∏—Å—å –≤–∞–ª–∏–¥–Ω–∞:</strong> 
              <span class="badge success">{{ verifyOriginalMessage() ? '‚úÖ –î–ê' : '‚ùå –ù–ï–¢' }}</span>
            </p>
          </div>
          
          <div class="comparison-col tampered">
            <h4>üî¥ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h4>
            <p><strong>–°–æ–æ–±—â–µ–Ω–∏–µ:</strong> {{ tamperedMessage }}</p>
            <p><strong>Hash:</strong> <code>{{ tamperedHash }}</code></p>
            <p><strong>–ü–æ–¥–ø–∏—Å—å –≤–∞–ª–∏–¥–Ω–∞:</strong> 
              <span class="badge error">{{ tamperedVerificationResult ? '‚úÖ –î–ê (!)' : '‚ùå –ù–ï–¢' }}</span>
            </p>
          </div>
        </div>

        <div class="conclusion-box" *ngIf="tamperedVerificationResult === false">
          <h4>üéØ –í—ã–≤–æ–¥</h4>
          <p>
            –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏–≤–µ–ª–æ –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ö—ç—à–∞, –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ 
            <strong>–ü–†–û–í–ê–õ–ò–õ–ê–°–¨</strong>. –≠—Ç–æ –¥–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ:
          </p>
          <ul>
            <li>–ü–æ–¥–ø–∏—Å—å –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é</li>
            <li>–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–¥–ø–∏—Å–∏</li>
            <li>–ë–ª–æ–∫—á–µ–π–Ω –∑–∞—â–∏—â—ë–Ω –æ—Ç –ø–æ–¥–¥–µ–ª–∫–∏ –¥–∞–Ω–Ω—ã—Ö</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <!-- –ó–ê–î–ê–ù–ò–ï 5: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–µ–π -->
  <div class="tab-content" *ngIf="currentTab === 'task5'">
    <h2>–ó–∞–¥–∞–Ω–∏–µ 5: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∏ –∏ –∏—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞</h2>
    
    <div class="task-description">
      <p>
        –ü–æ–¥–ø–∏—à–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ–¥–Ω–∏–º –∫–ª—é—á–æ–º –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –∏—Ö –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å.
        –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏.
      </p>
    </div>

    <button class="primary-btn" (click)="runMultipleSignaturesTest()">
      üîÑ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π
    </button>

    <div class="result-block" *ngIf="comparisonResults.length > 0">
      <h3>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–µ–π</h3>
      
      <table class="signatures-table">
        <thead>
          <tr>
            <th>#</th>
            <th>–°–æ–æ–±—â–µ–Ω–∏–µ</th>
            <th>Hash (—Ñ—Ä–∞–≥–º–µ–Ω—Ç)</th>
            <th>–ü–æ–¥–ø–∏—Å—å (—Ñ—Ä–∞–≥–º–µ–Ω—Ç)</th>
            <th>–í–∞–ª–∏–¥–Ω–æ—Å—Ç—å</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let result of comparisonResults; let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ result.message }}</td>
            <td><code>{{ result.hash }}</code></td>
            <td><code>{{ result.signature }}</code></td>
            <td>
              <span [class]="result.valid ? 'badge success' : 'badge error'">
                {{ result.valid ? '‚úÖ Valid' : '‚ùå Invalid' }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="info-box">
        <p>
          ‚ÑπÔ∏è –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –º–æ–≥—É—Ç –∏–º–µ—Ç—å –†–ê–ó–ù–´–ï –ø–æ–¥–ø–∏—Å–∏ 
          –∏–∑-–∑–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ k, –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –≤ –∞–ª–≥–æ—Ä–∏—Ç–º–µ ECDSA.
          –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–æ—Ç–∏–≤ –∞—Ç–∞–∫.
        </p>
      </div>
    </div>
  </div>

  <!-- –ö–û–ù–¢–†–û–õ–¨–ù–´–ï –í–û–ü–†–û–°–´ -->
  <div class="tab-content" *ngIf="currentTab === 'questions'">
    <h2>‚ùì –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h2>
    
    <div class="question-block">
      <h3>1. –í —á—ë–º –æ—Ç–ª–∏—á–∏–µ ECDSA –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ RSA-–ø–æ–¥–ø–∏—Å–∞–Ω–∏—è?</h3>
      <textarea 
        [(ngModel)]="answers.q1" 
        rows="4" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..."></textarea>
      <!-- <details class="hint-details">
        <summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary>
        <p>–°—Ä–∞–≤–Ω–∏—Ç–µ –¥–ª–∏–Ω—É –∫–ª—é—á–µ–π, –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ—Å–Ω–æ–≤—É, —Å–∫–æ—Ä–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π...</p>
      </details> -->
    </div>

    <div class="question-block">
      <h3>2. –ü–æ—á–µ–º—É –±–ª–æ–∫—á–µ–π–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–º–µ–Ω–Ω–æ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏–≤—ã–µ secp256k1?</h3>
      <textarea 
        [(ngModel)]="answers.q2" 
        rows="4" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..."></textarea>
      <!-- <details class="hint-details">
        <summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary>
        <p>–ü–æ–¥—É–º–∞–π—Ç–µ –æ –±–∞–ª–∞–Ω—Å–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–∑–º–µ—Ä–µ –¥–∞–Ω–Ω—ã—Ö...</p>
      </details> -->
    </div>

    <div class="question-block">
      <h3>3. –ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ—Å–ª–µ –µ—ë –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è?</h3>
      <textarea 
        [(ngModel)]="answers.q3" 
        rows="4" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..."></textarea>
      <!-- <details class="hint-details">
        <summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary>
        <p>–í—Å–ø–æ–º–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ó–∞–¥–∞–Ω–∏—è 4...</p>
      </details> -->
    </div>

    <div class="question-block">
      <h3>4. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –µ—Å–ª–∏ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–ª—é—á —É—Ç–µ—á—ë—Ç?</h3>
      <textarea 
        [(ngModel)]="answers.q4" 
        rows="4" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..."></textarea>
      <!-- <details class="hint-details">
        <summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary>
        <p>–ü–æ–¥—É–º–∞–π—Ç–µ –æ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è—Ö –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –∫–æ—à–µ–ª—å–∫–∞...</p>
      </details> -->
    </div>

    <div class="question-block">
      <h3>5. –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –ø–∞—Ä—É –∫–ª—é—á–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –±–ª–æ–∫—á–µ–π–Ω-—Å–µ—Ç–µ–π?</h3>
      <textarea 
        [(ngModel)]="answers.q5" 
        rows="4" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..."></textarea>
      <!-- <details class="hint-details">
        <summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary>
        <p>Bitcoin –∏ Ethereum –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–Ω—É –∫—Ä–∏–≤—É—é, –Ω–æ —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∞–¥—Ä–µ—Å–æ–≤...</p>
      </details> -->
    </div>
  </div>
</div>
